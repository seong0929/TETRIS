<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ko"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SettingPane.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tetris</a> &gt; <a href="index.source.html" class="el_package">org.teamseven.tetris.ui</a> &gt; <span class="el_source">SettingPane.java</span></div><h1>SettingPane.java</h1><pre class="source lang-java linenums">package org.teamseven.tetris.ui;

import org.teamseven.tetris.Pipeline;
import org.teamseven.tetris.enums.ColorBlindnessType;
import org.teamseven.tetris.enums.Mode;
import org.teamseven.tetris.enums.ScreenSize;
import org.teamseven.tetris.handler.PreferencesHandler;
import org.teamseven.tetris.handler.ScoreMemoryHandler;

import javax.swing.*;
import javax.swing.border.TitledBorder;
import java.awt.*;
import java.awt.event.*;

public class SettingPane extends JLayeredPane implements IDesign {

    JRadioButton rbSmallSize, rbMediumSize, rbLargeSize, rbEasy, rbNormal, rbHard, rbNone, rbColorBlindess;
    JButton btnInitScoreboard, btnLeft, btnRight, btnRotateRight, btnHardDrop, btnSoftDrop, btnPause, btnExit, btnInit, btnConfirm;
    JLabel lScreenSize, lGameMode, lScoreboard, lBlindess;
    JPanel pScreenSize, pGameMode, pKeyboard, pScoreboard, pBlindess, pButton;
    GridBagLayout gb;
    GridBagConstraints gbc;

<span class="nc" id="L24">    public SettingPane() {</span>
<span class="nc" id="L25">        setComp();</span>
<span class="nc" id="L26">        setDesign();</span>
<span class="nc" id="L27">        setAction();</span>
<span class="nc" id="L28">    }</span>

    @Override
    public void setComp() {
<span class="nc" id="L32">        gb = new GridBagLayout();</span>
<span class="nc" id="L33">        setLayout(gb);</span>
<span class="nc" id="L34">        gbc = new GridBagConstraints();</span>

        /*
            게임 화면 크기
         */
<span class="nc" id="L39">        lScreenSize = new JLabel(&quot;화면 크기 : &quot;);</span>
<span class="nc" id="L40">        pScreenSize = new JPanel(new FlowLayout(FlowLayout.LEFT));</span>
<span class="nc" id="L41">        rbSmallSize = new JRadioButton(&quot;작게&quot;,true);</span>
<span class="nc" id="L42">        rbMediumSize = new JRadioButton(&quot;보통&quot;,true);</span>
<span class="nc" id="L43">        rbLargeSize = new JRadioButton(&quot;크게&quot;,true);</span>
<span class="nc" id="L44">        ButtonGroup groupScreenSize = new ButtonGroup();</span>
<span class="nc" id="L45">        groupScreenSize.add(rbSmallSize);</span>
<span class="nc" id="L46">        groupScreenSize.add(rbMediumSize);</span>
<span class="nc" id="L47">        groupScreenSize.add(rbLargeSize);</span>
<span class="nc" id="L48">        pScreenSize.add(rbSmallSize);</span>
<span class="nc" id="L49">        pScreenSize.add(rbMediumSize);</span>
<span class="nc" id="L50">        pScreenSize.add(rbLargeSize);</span>

        /*
            일반 게임 모드 난이도 설정
         */
<span class="nc" id="L55">        lGameMode = new JLabel(&quot;일반 게임모드 난이도 : &quot;);</span>
<span class="nc" id="L56">        pGameMode = new JPanel(new FlowLayout(FlowLayout.LEFT));</span>
<span class="nc" id="L57">        rbEasy = new JRadioButton(&quot;Easy&quot;,true);</span>
<span class="nc" id="L58">        rbNormal = new JRadioButton(&quot;Normal&quot;,true);</span>
<span class="nc" id="L59">        rbHard = new JRadioButton(&quot;Hard&quot;,true);</span>
<span class="nc" id="L60">        ButtonGroup groupGameMOde = new ButtonGroup();</span>
<span class="nc" id="L61">        groupGameMOde.add(rbEasy);</span>
<span class="nc" id="L62">        groupGameMOde.add(rbNormal);</span>
<span class="nc" id="L63">        groupGameMOde.add(rbHard);</span>
<span class="nc" id="L64">        pGameMode.add(rbEasy);</span>
<span class="nc" id="L65">        pGameMode.add(rbNormal);</span>
<span class="nc" id="L66">        pGameMode.add(rbHard);</span>

        /*
            게임 키 설정
         */
<span class="nc" id="L71">        pKeyboard = new JPanel();</span>
<span class="nc" id="L72">        pKeyboard.setBorder(new TitledBorder(null, &quot;키 설정&quot;, TitledBorder.LEADING, TitledBorder.TOP, null, null));</span>
<span class="nc" id="L73">        GridLayout gridLayout = new GridLayout(10, 2);</span>
<span class="nc" id="L74">        pKeyboard.setLayout(gridLayout);</span>
<span class="nc" id="L75">        pKeyboard.add(new JLabel(&quot;왼쪽 이동&quot;));</span>
<span class="nc" id="L76">        btnLeft = new JButton(&quot;&quot;);</span>
<span class="nc" id="L77">        pKeyboard.add(btnLeft);</span>
<span class="nc" id="L78">        pKeyboard.add(new JLabel(&quot;오른쪽 이동&quot;));</span>
<span class="nc" id="L79">        btnRight = new JButton(&quot;&quot;);</span>
<span class="nc" id="L80">        pKeyboard.add(btnRight);</span>
<span class="nc" id="L81">        pKeyboard.add(new JLabel(&quot;시계 방향 회전&quot;));</span>
<span class="nc" id="L82">        btnRotateRight = new JButton(&quot;&quot;);</span>
<span class="nc" id="L83">        pKeyboard.add(btnRotateRight);</span>
<span class="nc" id="L84">        pKeyboard.add(new JLabel(&quot;하드 드롭&quot;));</span>
<span class="nc" id="L85">        btnHardDrop = new JButton(&quot;&quot;);</span>
<span class="nc" id="L86">        pKeyboard.add(btnHardDrop);</span>
<span class="nc" id="L87">        pKeyboard.add(new JLabel(&quot;소프트 드롭&quot;));</span>
<span class="nc" id="L88">        btnSoftDrop = new JButton(&quot;&quot;);</span>
<span class="nc" id="L89">        pKeyboard.add(btnSoftDrop);</span>
<span class="nc" id="L90">        pKeyboard.add(new JLabel(&quot;일시 중지&quot;));</span>
<span class="nc" id="L91">        btnPause = new JButton(&quot;&quot;);</span>
<span class="nc" id="L92">        pKeyboard.add(btnPause);</span>
<span class="nc" id="L93">        pKeyboard.add(new JLabel(&quot;게임 종료&quot;));</span>
<span class="nc" id="L94">        btnExit = new JButton(&quot;&quot;);</span>
<span class="nc" id="L95">        pKeyboard.add(btnExit);</span>

        /*
            스코어보드
         */
<span class="nc" id="L100">        lScoreboard = new JLabel(&quot;스코어보드 : &quot;);</span>
<span class="nc" id="L101">        pScoreboard = new JPanel(new FlowLayout(FlowLayout.LEFT));</span>
<span class="nc" id="L102">        btnInitScoreboard = new JButton(&quot;초기화&quot;);</span>
<span class="nc" id="L103">        pScoreboard.add(btnInitScoreboard);</span>

        /*
            색각이상 모드
         */
<span class="nc" id="L108">        lBlindess = new JLabel(&quot;색각이상 모드 : &quot;);</span>
<span class="nc" id="L109">        pBlindess = new JPanel(new FlowLayout(FlowLayout.LEFT));</span>
<span class="nc" id="L110">        rbNone = new JRadioButton(&quot;끄기&quot;,true);</span>
<span class="nc" id="L111">        rbColorBlindess = new JRadioButton(&quot;켜기&quot;,true);</span>
<span class="nc" id="L112">        ButtonGroup groupBlindess = new ButtonGroup();</span>
<span class="nc" id="L113">        groupBlindess.add(rbNone);</span>
<span class="nc" id="L114">        groupBlindess.add(rbColorBlindess);</span>
<span class="nc" id="L115">        pBlindess.add(rbNone);</span>
<span class="nc" id="L116">        pBlindess.add(rbColorBlindess);</span>

        /*
            하단 버튼
         */
<span class="nc" id="L121">        pButton = new JPanel();</span>
<span class="nc" id="L122">        btnInit = new JButton(&quot;초기화&quot;);</span>
<span class="nc" id="L123">        btnConfirm = new JButton(&quot;확인&quot;);</span>
<span class="nc" id="L124">        pButton.add(btnInit);</span>
<span class="nc" id="L125">        pButton.add(btnConfirm);</span>
<span class="nc" id="L126">    }</span>

    @Override
    public void setDesign() {
<span class="nc" id="L130">        gbc.fill = GridBagConstraints.BOTH;</span>
<span class="nc" id="L131">        gbc.weightx = 1.0;</span>
<span class="nc" id="L132">        gbc.weighty = 1.0;</span>

<span class="nc" id="L134">        gbAdd(lScreenSize,0, 1, 1, 1);</span>
<span class="nc" id="L135">        gbAdd(pScreenSize, 1, 1, 3, 1);</span>

<span class="nc" id="L137">        gbAdd(lGameMode, 0, 2, 1, 1);</span>
<span class="nc" id="L138">        gbAdd(pGameMode, 1, 2, 3, 1);</span>

<span class="nc" id="L140">        gbAdd(pKeyboard, 0, 3, 4, 4);</span>

<span class="nc" id="L142">        gbAdd(lScoreboard, 0,7,1,1);</span>
<span class="nc" id="L143">        gbAdd(pScoreboard,1,7,3,1);</span>

<span class="nc" id="L145">        gbAdd(lBlindess, 0,8,1,1);</span>
<span class="nc" id="L146">        gbAdd(pBlindess,1,8,3,1);</span>

<span class="nc" id="L148">        gbAdd(pButton, 0, 9, 4, 1);</span>
<span class="nc" id="L149">    }</span>

    @Override
    public void setAction() {
        // Screen Size
<span class="nc" id="L154">        ActionListener screenSizeActionListener = new ActionListener() {</span>
            public void actionPerformed(ActionEvent actionEvent) {
                //AbstractButton aButton = (AbstractButton) actionEvent.getSource();
<span class="nc bnc" id="L157" title="All 2 branches missed.">                if(rbSmallSize.isSelected()) {</span>
<span class="nc" id="L158">                    PreferencesHandler.setScreenSize(ScreenSize.SMALL);</span>
<span class="nc" id="L159">                    Pipeline.changeScreenSize(ScreenSize.SMALL);</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">                } else if (rbMediumSize.isSelected()) {</span>
<span class="nc" id="L161">                    PreferencesHandler.setScreenSize(ScreenSize.MEDIUM);</span>
<span class="nc" id="L162">                    Pipeline.changeScreenSize(ScreenSize.MEDIUM);</span>
<span class="nc bnc" id="L163" title="All 2 branches missed.">                } else if (rbLargeSize.isSelected()) {</span>
<span class="nc" id="L164">                    PreferencesHandler.setScreenSize(ScreenSize.LARGE);</span>
<span class="nc" id="L165">                    Pipeline.changeScreenSize(ScreenSize.LARGE);</span>
                }
<span class="nc" id="L167">            }</span>
        };

<span class="nc" id="L170">        rbSmallSize.addActionListener(screenSizeActionListener);</span>
<span class="nc" id="L171">        rbMediumSize.addActionListener(screenSizeActionListener);</span>
<span class="nc" id="L172">        rbLargeSize.addActionListener(screenSizeActionListener);</span>

        // Game Mode
<span class="nc" id="L175">        ActionListener gameModeActionListener = new ActionListener() {</span>
            public void actionPerformed(ActionEvent actionEvent) {
<span class="nc bnc" id="L177" title="All 2 branches missed.">                if(rbEasy.isSelected()) {</span>
<span class="nc" id="L178">                    PreferencesHandler.setMode(Mode.EASY);</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">                } else if (rbNormal.isSelected()) {</span>
<span class="nc" id="L180">                    PreferencesHandler.setMode(Mode.NORMAL);</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">                } else if (rbHard.isSelected()) {</span>
<span class="nc" id="L182">                    PreferencesHandler.setMode(Mode.HARD);</span>
                }
<span class="nc" id="L184">            }</span>
        };

<span class="nc" id="L187">        rbEasy.addActionListener(gameModeActionListener);</span>
<span class="nc" id="L188">        rbNormal.addActionListener(gameModeActionListener);</span>
<span class="nc" id="L189">        rbHard.addActionListener(gameModeActionListener);</span>

        // Keyboard
<span class="nc" id="L192">        ActionListener keyboardActionListener = new ActionListener() {</span>
            @Override
            public void actionPerformed(ActionEvent ae) {
<span class="nc bnc" id="L195" title="All 2 branches missed.">                if(ae.getSource() instanceof JButton) {</span>
<span class="nc" id="L196">                    JDialog dialog = new JDialog(Pipeline.getMainFrame(), &quot;설정&quot;);</span>
<span class="nc" id="L197">                    dialog.setModal(true);</span>
<span class="nc" id="L198">                    JLabel label = new JLabel(&quot;키를 입력하세요&quot;);</span>
<span class="nc" id="L199">                    dialog.add(label);</span>
<span class="nc" id="L200">                    dialog.setLocationRelativeTo(null);</span>
<span class="nc" id="L201">                    dialog.setSize(100, 100);</span>
<span class="nc" id="L202">                    dialog.setResizable(false);</span>
<span class="nc" id="L203">                    dialog.setFocusTraversalKeysEnabled(false);</span>
<span class="nc" id="L204">                    dialog.addWindowListener(new WindowAdapter() {</span>
                        @Override
                        public void windowClosed(WindowEvent e) {
<span class="nc" id="L207">                            refreshPref();</span>
<span class="nc" id="L208">                        }</span>
                    });
<span class="nc" id="L210">                    dialog.addKeyListener(new KeyListener() {</span>
                        @Override
                        public void keyTyped(KeyEvent e) {

<span class="nc" id="L214">                        }</span>

                        @Override
                        public void keyPressed(KeyEvent e) {
<span class="nc" id="L218">                            System.out.println(e.getKeyCode());</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">                            if (ae.getSource() == btnLeft)</span>
<span class="nc" id="L220">                                PreferencesHandler.setLeftBtnCode(e.getKeyCode());</span>
<span class="nc bnc" id="L221" title="All 2 branches missed.">                            else if (ae.getSource() == btnRight)</span>
<span class="nc" id="L222">                                PreferencesHandler.setRightBtnCode(e.getKeyCode());</span>
<span class="nc bnc" id="L223" title="All 2 branches missed.">                            else if (ae.getSource() == btnRotateRight)</span>
<span class="nc" id="L224">                                PreferencesHandler.setRotateRightBtnCode(e.getKeyCode());</span>
<span class="nc bnc" id="L225" title="All 2 branches missed.">                            else if (ae.getSource() == btnHardDrop)</span>
<span class="nc" id="L226">                                PreferencesHandler.setHardDropBtnCode(e.getKeyCode());</span>
<span class="nc bnc" id="L227" title="All 2 branches missed.">                            else if (ae.getSource() == btnSoftDrop)</span>
<span class="nc" id="L228">                                PreferencesHandler.setSoftDropBtnCode(e.getKeyCode());</span>
<span class="nc bnc" id="L229" title="All 2 branches missed.">                            else if (ae.getSource() == btnPause)</span>
<span class="nc" id="L230">                                PreferencesHandler.setPauseBtnCode(e.getKeyCode());</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">                            else if (ae.getSource() == btnExit)</span>
<span class="nc" id="L232">                                PreferencesHandler.setExitBtnCode(e.getKeyCode());</span>

<span class="nc" id="L234">                            dialog.dispose();</span>
<span class="nc" id="L235">                        }</span>

                        @Override
                        public void keyReleased(KeyEvent e) {

<span class="nc" id="L240">                        }</span>
                    });
<span class="nc" id="L242">                    dialog.setVisible(true);</span>
                }
<span class="nc" id="L244">            }</span>
        };

<span class="nc" id="L247">        btnLeft.addActionListener(keyboardActionListener);</span>
<span class="nc" id="L248">        btnRight.addActionListener(keyboardActionListener);</span>
<span class="nc" id="L249">        btnRotateRight.addActionListener(keyboardActionListener);</span>
<span class="nc" id="L250">        btnHardDrop.addActionListener(keyboardActionListener);</span>
<span class="nc" id="L251">        btnSoftDrop.addActionListener(keyboardActionListener);</span>
<span class="nc" id="L252">        btnPause.addActionListener(keyboardActionListener);</span>
<span class="nc" id="L253">        btnExit.addActionListener(keyboardActionListener);</span>

        // Color Blindness
<span class="nc" id="L256">        ActionListener colorBlindnessActionListener = new ActionListener() {</span>
            public void actionPerformed(ActionEvent actionEvent) {
<span class="nc bnc" id="L258" title="All 2 branches missed.">                if(rbNone.isSelected()) {</span>
<span class="nc" id="L259">                    PreferencesHandler.setColorBlindnessType(ColorBlindnessType.NONE);</span>
<span class="nc bnc" id="L260" title="All 2 branches missed.">                } else if (rbColorBlindess.isSelected()) {</span>
<span class="nc" id="L261">                    PreferencesHandler.setColorBlindnessType(ColorBlindnessType.BLINDNESS);</span>
                }
<span class="nc" id="L263">            }</span>
        };

<span class="nc" id="L266">        rbNone.addActionListener(colorBlindnessActionListener);</span>
<span class="nc" id="L267">        rbColorBlindess.addActionListener(colorBlindnessActionListener);</span>

<span class="nc" id="L269">        btnConfirm.addActionListener(new ActionListener() {</span>
            @Override
            public void actionPerformed(ActionEvent e) {
<span class="nc" id="L272">                Pipeline.replacePane(new GameMenuPane());</span>
<span class="nc" id="L273">            }</span>
        });

<span class="nc" id="L276">        btnInitScoreboard.addActionListener(new ActionListener() {</span>
            @Override
            public void actionPerformed(ActionEvent e) {
<span class="nc" id="L279">                int result = JOptionPane.showConfirmDialog((Component) null, &quot;정말 스코어보드를 초기화 하시겠습니까?&quot;,</span>
                        &quot;확인&quot;, JOptionPane.OK_CANCEL_OPTION);
<span class="nc bnc" id="L281" title="All 2 branches missed.">                if(result == 0) {</span>
<span class="nc" id="L282">                    ScoreMemoryHandler scoreMemoryHandler = new ScoreMemoryHandler();</span>
<span class="nc" id="L283">                    scoreMemoryHandler.clear();</span>
                }
<span class="nc" id="L285">            }</span>
        });

<span class="nc" id="L288">        btnInit.addActionListener(new ActionListener() {</span>
            @Override
            public void actionPerformed(ActionEvent e) {
<span class="nc" id="L291">                int result = JOptionPane.showConfirmDialog((Component) null, &quot;정말 스코어보드와 게임 설정을 초기화 하시겠습니까?&quot;,</span>
                        &quot;확인&quot;, JOptionPane.OK_CANCEL_OPTION);
<span class="nc bnc" id="L293" title="All 2 branches missed.">                if(result == 0) {</span>
<span class="nc" id="L294">                    ScoreMemoryHandler scoreMemoryHandler = new ScoreMemoryHandler();</span>
<span class="nc" id="L295">                    scoreMemoryHandler.clear();</span>
<span class="nc" id="L296">                    PreferencesHandler.clear();</span>
<span class="nc" id="L297">                    refreshPref();</span>
                }
<span class="nc" id="L299">            }</span>
        });

<span class="nc" id="L302">        refreshPref();</span>
<span class="nc" id="L303">    }</span>

    private void gbAdd(JComponent c, int x, int y, int w, int h){
<span class="nc" id="L306">        gbc.gridx = x;</span>
<span class="nc" id="L307">        gbc.gridy = y;</span>
<span class="nc" id="L308">        gbc.gridwidth = w;</span>
<span class="nc" id="L309">        gbc.gridheight = h;</span>
<span class="nc" id="L310">        gbc.insets = new Insets(2, 2, 2, 2);</span>
<span class="nc" id="L311">        add(c, gbc);</span>
<span class="nc" id="L312">    }</span>

    private void refreshPref() {
        // Screen Size
<span class="nc bnc" id="L316" title="All 4 branches missed.">        switch (PreferencesHandler.getScreenSize()) {</span>
            case SMALL:
<span class="nc" id="L318">                rbSmallSize.setSelected(true);</span>
<span class="nc" id="L319">                break;</span>
            case MEDIUM:
<span class="nc" id="L321">                rbMediumSize.setSelected(true);</span>
<span class="nc" id="L322">                break;</span>
            case LARGE:
<span class="nc" id="L324">                rbLargeSize.setSelected(true);</span>
                break;
        }

        // Game Mode
<span class="nc bnc" id="L329" title="All 4 branches missed.">        switch (PreferencesHandler.getMode()) {</span>
            case EASY:
<span class="nc" id="L331">                rbEasy.setSelected(true);</span>
<span class="nc" id="L332">                break;</span>
            case NORMAL:
<span class="nc" id="L334">                rbNormal.setSelected(true);</span>
<span class="nc" id="L335">                break;</span>
            case HARD:
<span class="nc" id="L337">                rbHard.setSelected(true);</span>
                break;
        }

        // Keyboard
<span class="nc" id="L342">        btnLeft.setText(KeyEvent.getKeyText(PreferencesHandler.getLeftBtnCode()));</span>
<span class="nc" id="L343">        btnRight.setText(KeyEvent.getKeyText(PreferencesHandler.getRightBtnCode()));</span>
<span class="nc" id="L344">        btnRotateRight.setText(KeyEvent.getKeyText(PreferencesHandler.getRotateRightBtnCode()));</span>
<span class="nc" id="L345">        btnHardDrop.setText(KeyEvent.getKeyText(PreferencesHandler.getHardDropBtnCode()));</span>
<span class="nc" id="L346">        btnSoftDrop.setText(KeyEvent.getKeyText(PreferencesHandler.getSoftDropBtnCode()));</span>
<span class="nc" id="L347">        btnPause.setText(KeyEvent.getKeyText(PreferencesHandler.getPauseBtnCode()));</span>
<span class="nc" id="L348">        btnExit.setText(KeyEvent.getKeyText(PreferencesHandler.getExitBtnCode()));</span>

        // Color Blindness
<span class="nc bnc" id="L351" title="All 3 branches missed.">        switch (PreferencesHandler.getColorBlindnessType()) {</span>
            case NONE:
<span class="nc" id="L353">                rbNone.setSelected(true);</span>
<span class="nc" id="L354">                break;</span>
            case BLINDNESS:
<span class="nc" id="L356">                rbColorBlindess.setSelected(true);</span>
                break;
        }
<span class="nc" id="L359">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>